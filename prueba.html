<!DOCTYPE html>
<html>

<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Firebase App is always required and must be first -->
    <script src="https://www.gstatic.com/firebasejs/5.0.1/firebase-app.js"></script>
    <!-- Add additional services that you want to use -->
    <script src="https://www.gstatic.com/firebasejs/5.0.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/5.0.1/firebase-database.js"></script>
    <script src="https://www.gstatic.com/firebasejs/5.0.1/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/5.0.1/firebase-messaging.js"></script>
    <script src="https://www.gstatic.com/firebasejs/5.0.1/firebase-functions.js"></script>
    <!-- Comment out (or don't include) services that you don't want to use -->
    <script src="https://www.gstatic.com/firebasejs/5.0.1/firebase-storage.js"></script>

    <script src="https://www.gstatic.com/firebasejs/ui/4.4.0/firebase-ui-auth.js"></script>
    <link type="text/css" rel="stylesheet" href="https://www.gstatic.com/firebasejs/ui/4.4.0/firebase-ui-auth.css" />
    <script src="https://www.gstatic.com/firebasejs/ui/4.4.0/firebase-ui-auth__es.js"></script>
    <link type="text/css" rel="stylesheet" href="https://www.gstatic.com/firebasejs/ui/4.4.0/firebase-ui-auth.css" />


    <script src="https://cdn.firebase.com/libs/firebaseui/3.5.2/firebaseui.js"></script>
    <link type="text/css" rel="stylesheet" href="https://cdn.firebase.com/libs/firebaseui/3.5.2/firebaseui.css" />


    <link rel="stylesheet" href="themes/alertify.core.css" />
    <link rel="stylesheet" href="themes/alertify.default.css" id="toggleCSS" />


    <script src="lib/alertify.min.js"></script>

    <!--script type="text/javascript" src="data.json"></script-->


    <!--script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBlkVvmzUIeVr_u2s1URIwq8P_GZ12QwoU"></script-->
    <meta name="fila_viewport" content="initial-scale=1.0, user-scalable=no" />
    <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
    <link rel="stylesheet" href="css/jquery.mobile-1.4.5.min.css">
    <script src="js/jquery-1.11.3.min.js"></script>
    <script src="js/jquery.mobile-1.4.5.min.js"></script>
    <title>Cita Previa Única</title>
    <base target="_parent">
</head>

<body>

    <style>
        .footer iframe {
            display: none;
        }
        
        .EAT_pie iframe {
            display: none;
        }
        
        A .header iframe {
            display: none;
        }
        
        .cabecera iframe {
            display: none !important;
        }
        
        .menu iframe {
            display: none;
        }
        
        .loginbox iframe {
            display: none;
        }
        
        .barrainfo iframe {
            display: none;
        }
        
        .cuerpo_misedeelectronica iframe {
            display: none;
            visible: hide;
        }
        
        .contenedor-responsivo {
            position: relative;
            overflow: hidden;
            padding-top: 56.25%;
        }
        
        ._parent {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: 0;
        }
    </style>


    <div class="contenedor-responsivo">
        <iframe class="_parent" src="citas.html" gesture="media" allow="encrypted-media" allowfullscreen " widht="100% " height="100% "></iframe>
</div>
<script>
    $(document).ready(function() {

        $("_parent ").on("focus ", "input ", function(event) {
            $(this).attr('autocomplete', 'on')
        });

        var favoritos = localStorage.getItem("favoritos ") || "[] ";
        favoritos = JSON.parse(favoritos);

        for (var j = 0; j < favoritos.length; j++) {
            //get filter text
            var posGeneral = favoritos[j].id;
            var nomb = favoritos[j].nombre;

            $("# " + posGeneral).show();
            $("# " + "agregar-favoritos_ " + posGeneral).attr("class ", "ui-btn ui-btn-icon-notext ui-icon-star ui-btn-a ");
        }


        $("a[id^='agregar-favoritos' ] ").click(
            function(e) {

                // hacemos que no se ejecute el enlace
                e.preventDefault();

                // leemos los datos clave del producto y los guardamos en un objeto


                var identi = $(this).attr("id ");
                identi = identi.substring(identi.indexOf("_ ") + 1);

                var datos = {
                    id: identi,
                    nombre: $("# " + identi).attr('visible')
                };

                // leemos los favoritos del localStorage
                var favoritos = localStorage.getItem("favoritos ") || "[] ";
                favoritos = JSON.parse(favoritos);

                // buscamos el producto en la lista de favoritos
                var posLista = favoritos.findIndex(function(e) {

                    return e.id == identi;
                });
                if (posLista > -1) {

                    // si está, lo quitamos
                    alertify.error("eliminado de favoritos ");
                    $("#fila_ " + identi).hide();

                    favoritos.splice(posLista, 1);

                } else {
                    // si no está, lo añadimos
                    $("#agregar-favoritos_ " + identi).attr("class ", "ui-btn ui-btn-icon-notext ui-icon-star ui-btn-a ");
                    alertify.success("añadido favoritos ");

                    // $("# " + identi).show();


                    favoritos.push(datos);
                }

                // guardamos la lista de favoritos 
                localStorage.setItem("favoritos ", JSON.stringify(favoritos));

            }


        );


    });

    $('#favorito').click(function(e) {
        var filtvalue = "show ";
        var favoritos = localStorage.getItem("favoritos ") || "[] ";
        favoritos = JSON.parse(favoritos);

        $("li[id^='fila_' ] ").hide();

        for (var j = 0; j < favoritos.length; j++) {
            $("#fila_ " + favoritos[j].id).show();
            $("#agregar-favoritos_ " + favoritos[j].id).attr("class ", "ui-btn ui-btn-icon-notext ui-icon-star ui-btn-a ");
        }

        $("li[id^='contenedor_' ] ").each(function() {
            var numerofavoritos = 0;


            $(this).find("li ").each(function() {
                var iden = $(this).attr("id ");
                iden = iden.substring(iden.indexOf("_ ") + 1);
                var encontrado = false;
                for (var i = 0; i < favoritos.length && !encontrado; i++) {
                    encontrado = favoritos[i].id == iden;
                }
                if (encontrado) {
                    numerofavoritos++;
                }

            });
            if (numerofavoritos == 0) {
                $(this).hide();

            }


        });

    });
    $('#todos').click(function(e) {
        var filtvalue = "hide ";


        $("#theList ").find("li ").each(function(idx) {
            //get filter text
            var filtText = $(this).attr("visible ");

            if (filtText != undefined && filtText == "hide ") {

                $(this).hide();
            } else {
                $(this).show();
            }
        });
    });
</script>
</body>
</html>